<input type="hidden" id="g-recaptcha-response" name="g-recaptcha-response">
<input type="hidden" name="action" value="validate_captcha">
<p style="font-size: 0.75rem">
    This site is protected by reCAPTCHA and the Google
        <a href="https://policies.google.com/privacy">Privacy Policy</a> and
        <a href="https://policies.google.com/terms">Terms of Service</a> apply.
</p>
<script>
    function refresh() {
        grecaptcha.execute('{{ config["RECAPTCHA_PUBLIC_KEY_V3"] }}', {action:'validate_captcha'})
                  .then(function(token) {
                        document.getElementById('g-recaptcha-response').value = token;
                    });
    }

    grecaptcha.ready(function() {
        refresh();
    });

    window.addEventListener("load", () => {
        $(document).on("refreshCaptcha", () => {
            refresh();
        });
    });
</script>
